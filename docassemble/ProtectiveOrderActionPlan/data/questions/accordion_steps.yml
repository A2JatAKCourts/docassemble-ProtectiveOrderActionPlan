comment: |
  2025-10-22
    added logic and interview order for user asking for protective order for children
---
generic object: ALDocumentBundle
template: x.get_email_copy
content: |
  Email a copy of your Action Plan to yourself or someone else
---
generic object: ALDocumentBundle
template: x.send_email_template
subject: |
  Your Protective Order Action Plan
content: |
  Thank you for using the Alaska Court System's Court Guide Action Plan.

  Your Action Plan is attached.

  Get [more information and a list of all the Court Guide Action Plans](https://ak-courts.info/ActionPlan).  
  
  [ak-courts.info/ActionPlan](https://ak-courts.info/ActionPlan).
---
id: final screen
decoration: pen-to-square
event: confirmation_and_download
question: |
  % if len(step_list) < 2:
  Get more information or help
  % else:
  # <i class="fa-thin fa-list"></i>Your Action Plan is ready!
  % endif
subquestion: |
  #### Your Protective Order Action Plan in ${ len(step_list) } steps
 
  % if get_config("debug", False):
  <button id="akc_expand_all" class="btn other stuff">Expand all</button>
  <button id="akc_collapse_all" class="btn other stuff">Collapse all</button>
  % endif  
  
  % for iteration_index, step_tuple in enumerate( step_list ):
  ${ collapse_template(step_tuple[0], closed_icon="plus", open_icon="minus") }
  % endfor
  
  ${ al_user_bundle.download_list_html() }
  
  &nbsp;

  ${ al_user_bundle.send_button_html(show_editable_checkbox=False) }
  
  % if get_config("debug", False):
  [get the docx file](${ docx_protective_order_action_plan_attachment.docx.url_for() })
  % endif 
   
buttons:
  - Start over: restart
script: |
  <script>
  let expander = $("#akc_expand_all")
  expander.on("click", function () {
   Array.from(document.querySelectorAll('.al_collapse_template .collapse')).forEach((elem) => { elem.className += " show" })
  })
  
  let collapser = $("#akc_collapse_all")
  collapser.on("click", function () {
      Array.from(document.querySelectorAll('.al_collapse_template .collapse')).forEach((elem) => { elem.className = elem.className.replace(" show", "" ) })
  })
  </script>
---
code: |
  step_list = []
  if len(step_list) >= 2:
    pdf_pap_multistep_subtitle = True
  images_list = []
  distribution_certificate_list = []
  reply_certificate_list = []
  other_party_in_case  = ''
  # case_type = 'custody case'  
  type_of_response['ak custody case'] = False 
  # distribution_certificate_list.append({'image': distrib_cert_custody_divorce_image, 'text': "Certificate of Distribution shows the date the court sent your order to you."})
  # expect_after_motion is in what to expect step for filing motion for interim order w complaint, or answer/response, cannot use variable in docx template, must insert condition in what to expect step.
  expect_after_motion = ''
  file_motion_to_set_aside = ''
  file_motion_to_enforce = ''
  file_modify_filing_fee = ''
  # reply_certificate_list.append({'image': service_cert_reply_image, 'text': "Certificate of Service at the bottom of the Reply form."})
  # motion_type used in expect_after_motion_step "What to expect after you file a ${ motion_type }"
  motion_type = 'motion or Answer'

  
  # if len(type_of_response.true_values()) > 1:
  #   add_unique_step((pick_a_step_step, "pick_a_step_idx"), step_list)

  if user_need == 'want po':
    add_unique_step((stay_safe_step, "stay_safe_idx"), step_list)
    if options_for_po['military']:
      add_unique_step((military_po_info_step, "military_po_info_idx"), step_list)
    if options_for_po['tribal']:
      add_unique_step((tribal_po_info_step, "tribal_po_info_idx"), step_list)
    if options_for_po['AK court']:
      if who_needs_the_order == 'self':
        if self_related_to_abuser['married']:
          add_unique_step((divorce_po_info_step, "divorce_po_info_idx"), step_list)
        if self_related_to_abuser['have child']:
          if self_related_to_abuser.all_false('married', 'divorced'): 
            add_unique_step((custody_case_step, "custody_case_idx"), step_list)
          else:
            add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
        if self_related_to_abuser.any_true('married', 'divorced') and not self_related_to_abuser['have child']:
          if child_w_abuser:
            add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
        if self_related_to_abuser.any_true():
          if dv_crime == 'yes':
            add_unique_step((protective_order_info_step, "protective_order_info_idx"), step_list)
        else:
          no_qualifying_relationship = True
          if other_po['stalked']:
            add_unique_step((stalking_step, "stalking_idx"), step_list)
          if other_po['sexual contact']:
            add_unique_step((sa_step, "sa_idx"), step_list)
          
  
       
      if who_needs_the_order == 'child':
        if petitioner_related_to_child == 'parent':
          if child_related_to_abuser['have child']:
            add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
          if child_related_to_abuser.any_true() or (child_related_to_abuser.all_false() and petitioner_related_to_child == 'parent' and parent_related_to_abuser.any_true()) or (child_related_to_abuser.all_false() and petitioner_related_to_child == 'parent' and parent_related_to_abuser.all_false() and other_parent_related_to_abuser.any_true()):
            if dv_crime == 'yes':
              add_unique_step((protective_order_info_step, "protective_order_info_idx"), step_list)
          else:
            if other_po['stalked']:
              add_unique_step((stalking_step, "stalking_idx"), step_list)
            if other_po['sexual contact']:
              add_unique_step((sa_step, "sa_idx"), step_list)
        elif petitioner_related_to_child in('guardian', 'representative'):
          if guardian_for_child_related_to_abuser['have child']:
            add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
          if guardian_for_child_related_to_abuser.any_true():
            if dv_crime == 'yes':
              add_unique_step((protective_order_info_step, "protective_order_info_idx"), step_list)
          else:
            if other_po['stalked']:
              add_unique_step((stalking_step, "stalking_idx"), step_list)
            if other_po['sexual contact']:
              add_unique_step((sa_step, "sa_idx"), step_list)

      if who_needs_the_order == 'self and child':
        if petitioner_related_to_child == 'parent': 
          if po_against_other_parent:
            add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
            if parent_related_parent == 'married':
              add_unique_step((divorce_po_info_step, "divorce_po_info_idx"), step_list)
            if parent_related_parent == 'no':
              add_unique_step((custody_case_step, "custody_case_idx"), step_list)
            if dv_crime in('yes one', 'yes both'):
              add_unique_step((protective_order_info_step, "protective_order_info_idx"), step_list)
          else:
            if self_related_to_abuser['married']:
              add_unique_step((divorce_po_info_step, "divorce_po_info_idx"), step_list)
            if self_related_to_abuser['have child']:
              add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
            if self_related_to_abuser.any_true():
              if dv_crime == 'yes both':
                add_unique_step((protective_order_more_than_one_step, "protective_order_more_than_one_idx"), step_list)
              if dv_crime == 'yes one':
                  add_unique_step((protective_order_for_one_step, "protective_order_for_one_idx"), step_list)
            
            else:
              if what_next == 'other po for me':
                if other_po['stalked']:
                  add_unique_step((stalking_step, "stalking_idx"), step_list)
                if other_po['sexual contact']:
                  add_unique_step((sa_step, "sa_idx"), step_list)
  
              if what_next == 'stop for me':
                if child_related_to_abuser['have child'] or (child_related_to_abuser.all_false() and filing_parent_does_not_qualify_other_parent_related_to_abuser['have child']):
                  add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
                if child_related_to_abuser.any_true() or (child_related_to_abuser.all_false() and filing_parent_does_not_qualify_other_parent_related_to_abuser.any_true()):
                  if dv_crime == 'yes':
                    add_unique_step((protective_order_info_step, "protective_order_info_idx"), step_list)
                else: 
                  if other_po['stalked']:
                    add_unique_step((stalking_step, "stalking_idx"), step_list)
                  if other_po['sexual contact']:
                    add_unique_step((sa_step, "sa_idx"), step_list)
  
        if petitioner_related_to_child in('guardian', 'representative'):
          if self_related_to_abuser['married']:
            add_unique_step((divorce_po_info_step, "divorce_po_info_idx"), step_list)
          if self_related_to_abuser['have child']:
            add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
          if self_related_to_abuser.any_true():
            if guardian_and_child_child_related_to_abuser['married']:
              add_unique_step((divorce_po_info_step, "divorce_po_info_idx"), step_list)
            if guardian_and_child_child_related_to_abuser['have child']:
              add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
            if guardian_and_child_child_related_to_abuser.any_true():
              if dv_crime == 'yes both':
                add_unique_step((protective_order_more_than_one_step, "protective_order_more_than_one_idx"), step_list)
              if dv_crime == 'yes one':
                add_unique_step((protective_order_for_one_step, "protective_order_for_one_idx"), step_list)
            else: ## guardian_and_child_child_related_to_abuser.all_false            
              if what_next == 'stop for child':
                  if dv_crime == 'yes':
                    add_unique_step((protective_order_for_one_step, "protective_order_for_one_idx"), step_list)
              elif what_next == 'continue for both':
                if dv_crime == 'yes both':
                  add_unique_step((protective_order_more_than_one_step, "protective_order_more_than_one_idx"), step_list)
                if dv_crime == 'yes one':
                  add_unique_step((protective_order_for_one_step, "protective_order_for_one_idx"), step_list)
              else: ## what_next == 'stop for me'
                  if other_po['stalked']:
                    add_unique_step((stalking_step, "stalking_idx"), step_list)
                  if other_po['sexual contact']:
                    add_unique_step((sa_step, "sa_idx"), step_list)
  
          if self_related_to_abuser.all_false(): 
            if what_next == 'stop for me': 
              if guardian_for_child_related_to_abuser['married']:
                add_unique_step((divorce_po_info_step, "divorce_po_info_idx"), step_list)
              if guardian_for_child_related_to_abuser['have child']:
                add_unique_step((child_w_other_side_step, "child_w_other_side_idx"), step_list)
              if guardian_for_child_related_to_abuser.any_true():
                if dv_crime == 'yes':
                  add_unique_step((protective_order_for_one_step, "protective_order_for_one_idx"), step_list) 
            if what_next == 'other po for me':
                if other_po['stalked']:
                  add_unique_step((stalking_step, "stalking_idx"), step_list)
                if other_po['sexual contact']:
                  add_unique_step((sa_step, "sa_idx"), step_list)

      if who_needs_the_order == 'children':   
        if petitioner_related_to_children != 'other':
          if domestic_violence_po_criteria:
            if children_related_to_abuser == 'all':
              if dv_crime == 'yes more':
                add_unique_step((protective_order_more_than_one_step, "protective_order_more_than_one_idx"), step_list)
              if dv_crime == 'yes one':
                  add_unique_step((protective_order_for_one_step, "protective_order_for_one_idx"), step_list) 
            elif children_related_to_abuser in('one', 'some'):
              if what_next == 'order for one':
                if dv_crime == 'yes':
                  add_unique_step((protective_order_for_one_step, "protective_order_for_one_idx"), step_list) 
              if what_next == 'order for more':
                if dv_crime == 'yes more':
                  add_unique_step((protective_order_more_than_one_step, "protective_order_more_than_one_idx"), step_list)
                elif dv_crime == 'yes one':
                  add_unique_step((protective_order_for_one_step, "protective_order_for_one_idx"), step_list) 
              if what_next == 'stop':
                if other_po['stalked']:
                  add_unique_step((stalking_step, "stalking_idx"), step_list)
                if other_po['sexual contact']:
                  add_unique_step((sa_step, "sa_idx"), step_list)
            else:
                if other_po['stalked']:
                  add_unique_step((stalking_step, "stalking_idx"), step_list)
                if other_po['sexual contact']:
                  add_unique_step((sa_step, "sa_idx"), step_list)
    
            
          
  
               
  

      
            

       
          
  
  # if user_need == 'have po':
  # if user_need == 'register po':
  # if user_need == 'po defendant':

  
  #  add_unique_image({'image': service_cert_image, 'text': "Certificate of Service"}, images_list)
  #  add_unique_step((cert_of_service_step, "cert_of_service_idx"), step_list)
  #  add_unique_step((answer_file_and_serve_step, "answer_file_and_serve_idx"), step_list)

    
  
   # add_unique_step((expect_after_answer_step, "expect_after_answer_idx"), step_list)

   #if :
   #  add_unique_step((learn_more_about_process_step, "learn_more_about_process_idx"), step_list)
  
  
  
  
  add_unique_step((get_help, "get_help_idx"), step_list)
    
  for iter_idx, step_tuple in enumerate( step_list ):
    define(step_tuple[ 1 ], iter_idx + 1)
  get_steps = True
---
code: |
  def add_unique_step(step, step_list):
    is_unique = True
    for chair in step_list:
      if chair[1] == step[1]:
        is_unique = False
    if is_unique:
      step_list.append(step)
      
  #if foo:
  #  add_unique_step((file_step, "file_idx"), step_list)
---
code: |
  def add_unique_image(new_image, image_list):
    is_unique = True
    for image in image_list:
      if image['image'] == new_image['image']:
        is_unique = False
    if is_unique:
      image_list.append(new_image)
---
template: stay_safe_step
subject: |
  Step ${stay_safe_idx}:
  Stay safe step
content: | 
  Stay safe info and resources
---
template: military_po_info_step
subject: |
  Step ${military_po_info_idx}:
  Military protective order info step
content: |
  military po info and resources
---
template: tribal_po_info_step
subject: |
  Step ${tribal_po_info_idx}:
  Tribal protective order info step
content: |
  tribal po info and resources
---
template: divorce_po_info_step
subject: |
  Step ${divorce_po_info_idx}:
  Divorce protective order info step
content: |
  divorce po info and resources
---
template: custody_case_step
subject: |
  Step ${custody_case_idx}:
  Custody protective order info step
content: |
  custody po info and resources
---
template: child_w_other_side_step
subject: |
  Step ${child_w_other_side_idx}:
  Protective Order info when child with other side step
content: |
  Protective Order info when person who needs order or their parent has a child with other side
---
template: protective_order_info_step
subject: |
  Step ${ protective_order_info_idx }:
  Protective Order step
content: |
  Protective Order information
---
template: protective_order_more_than_one_step
subject: |
  Step ${ protective_order_more_than_one_idx }:
  Protective Order information for more than one person
content: |
  Learn about the [Petition for Domestic Violence Protective Orders (Multiple Petitioners)](https://public.courts.alaska.gov/web/forms/docs/dv-100-127-multi.pdf)
---
template: protective_order_for_one_step
subject: |
  Step ${ protective_order_for_one_idx }:
  Protective Order information for one person
content: |
  Learn about the [Petition for Domestic Violence Protective Orders (One Petitioner)](https://public.courts.alaska.gov/web/forms/docs/dv-100-127-one.pdf)

  Or you can use "[Petition wizard](http://www.courts.alaska.gov/forms/cipo/)" to help you complete this form online.
---
template: stalking_step
subject: |
  Step ${ stalking_idx }:
  Stalking Protective Order step
content: |
  Stalking Protective Order information
---
template: sa_step
subject: |
  Step ${ sa_idx }:
  Sexual Assault Protective Order step
content: |
  Sexual Assault Protective Order information
---
template: dont_qualify_placeholder_language
content: |
  % if no_qualifying_relationship:  
  Based on your answers, a domestic violence protective order may not be appropriate if there was no domestic violence crime. 
  % if who_needs_the_order == 'self':
  You 
  % elif who_needs_the_order == 'child':
  % if petitioner_related_to_child == 'parent':
  Your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  The
  % endif
  child
  % elif who_needs_the_order == 'self and child':
  You or 
  % if petitioner_related_to_child == 'parent':
  your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  the
  % endif
  child
  % elif who_needs_the_order == 'children':
  % if petitioner_related_to_child == 'parent':
  Your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  The
  % endif
  children
  % elif who_needs_the_order == 'self and children':
  You or 
  % if petitioner_related_to_child == 'parent':
  your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  the 
  % endif 
  children
  % endif 
  may be experiencing domestic violence that may not be considered a crime under the law such as calling you names, making you feel like you shouldn't talk to friends or family, or limiting access to money. 
  
  If
  % if who_needs_the_order == 'self':
  you do not
  % elif who_needs_the_order == 'child':
  % if petitioner_related_to_child == 'parent':
  your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  the
  % endif
  child does not
  % elif who_needs_the_order == 'self and child':
  you and
  % if petitioner_related_to_child == 'parent':
  your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  the
  % endif
  child do not
  % elif who_needs_the_order == 'children':
  % if petitioner_related_to_child == 'parent':
  your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  the
  % endif
  children do not
  % elif who_needs_the_order == 'self and children':
  you and 
  % if petitioner_related_to_child == 'parent':
  your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  the 
  % endif 
  children do not
  % endif 
  qualify for a protective order you can take steps to 
  % if who_needs_the_order in('child', 'children'):
  keep them
  % else:
  stay 
  % endif
  safe. 
  
  Information about options and safety planning has been added to your Action Plan.
  % endif
