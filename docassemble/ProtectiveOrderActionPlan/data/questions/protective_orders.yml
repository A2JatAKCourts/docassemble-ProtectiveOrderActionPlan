Comment: |
  2025-12-16
---
include:
  - docassemble.AssemblyLine:assembly_line.yml
  - docassemble.AKA2JBranding:custom_organization.yml
  - docassemble.AKA2JBranding:aka2j_templates.yml
  - accordion_steps.yml
---
default screen parts:
  post: |
    <style>
      /* CSS-only help bubble */
      .da-help-wrap{position:relative; display:inline-block; vertical-align:middle;}
      .da-help-icon{cursor:help; display:inline-block; line-height:1; }
      .da-help-box{
        position:absolute; z-index:10000; top:1.35em; left:0;
        background:#fff; border:1px solid rgba(0,0,0,.15); border-radius:.5rem;
        padding:.6rem .8rem; box-shadow:0 .5rem 1rem rgba(0,0,0,.15);
        max-width:320px; min-width:220px; line-height:1.25; font-size:.95em;
        display:none;
      }
      /* show on hover OR keyboard focus */
      .da-help-wrap:hover .da-help-box,
      .da-help-wrap:focus-within .da-help-box{ display:block; }
      .da-help-box ul{margin:0; padding-left:1.2em;}
      /* optional: nudge when placed at end of a bullet line */
      li > .da-help-wrap{ margin-left: .35rem; }
    </style>

---
metadata:
  title: >-
    Protective Orders  - action plan
  short title: >-
    Protective Orders
  description: |-
    Action plan for asking for, changing, ending, extending, registering, or responding to a protective order and safety plan if you do not qualify for a protective order.
  tags:
    - "FA-04-00-00-00"
    - "FA-07-07-00-00"
    - "FA-07-01-00-00"
    - "FA-07-03-00-00"
    - "FA-07-11-00-00"
  authors:
    - Alaska Court System
  help_page_url: >-
    https://courts.alaska.gov/shc/dv
  help_page_title: >-
    Domestic Violence, Stalking or Sexual Assault
  allowed_courts: []
  typical_role: "defendant"
  generated_on: "2024-03-05"
---
code: |
  # This controls the default country and list of states in address field questions
  AL_DEFAULT_COUNTRY = "US"
---
code: |
  # This controls the default state in address field questions
  AL_DEFAULT_STATE = "Alaska"
---
code: |
  github_repo_name =  'ProtectiveOrderIssues'
---

code: |
  interview_short_title = "Protective Orders"
---
code: |
  al_form_type = "other" 
---
objects:
  - users: ALPeopleList
  - type_of_response: DADict.using(auto_gather=False)
---
features:
  css: 
    - NoRedAsterisk.css
# sections:
#   - review_protective_order_action_plan: Review your answers
---


---
#################### Interview order #####################
comment: |
  Controls order and branching logic for questions specific to this form
id: interview_order_protective_order_action_plan
code: |
  # Set the allowed courts for this interview
  # allowed_courts = []
  # nav.set_section("review_protective_order_action_plan")
  # user_role = "defendant"
  # user_ask_role = "defendant"
  # user_need = 'protective orders' 
  # type_of_response
  # type_of_response['default']
  # parents_agree_documents
  # set_progress(25)
  # domestic_violence
  # paternity
  get_steps
  interview_order_protective_order_action_plan = True
---
###################### Main order ######################
comment: |
  This block includes the logic for standalone interviews.
  Delete mandatory: True to include in another interview
mandatory: True
code: |
  # al_intro_screen
  protective_order_action_plan_intro
  interview_order_protective_order_action_plan
  # signature_date
  # Store anonymous data for analytics / statistics
  store_variables_snapshot(
      persistent=True,
      data={
          "zip": showifdef("users[0].address.zip"),
          "reached_interview_end": True,
      },
  )
  # protective_order_action_plan_download
  confirmation_and_download
---
comment: |
  This question is used to introduce your interview. Please customize
id: Protective Order Action Plan - intro 
continue button field: protective_order_action_plan_intro
question: |
  If you or someone else is in immediate danger, call 911
subquestion: |
  This Court Guide asks you questions and uses your answers to build an Action Plan - a list of steps to ask the court for the kind of help you need. Your Action Plan will include information about the Alaska court process and other resources.
fields:
  - What is your situation?: user_need
    datatype: radio
    choices:
      - "I want a protective order to protect myself or my child from another person.": want po
      - "I have a protective order from Alaska against someone else. I want to change or end it, ask the court to dismiss the petition, prepare for a long-term hearing, report a violation, or respond to a request to change or end it.": have po
      - "I have a protective order from another state or a tribal court against someone else. I want to register it with the Alaska Court System": register po
      - "Someone has a protective order against me.": po respondent
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####
  There are 3 types of protective orders available depending on your relationship with the other person and the other person's actions. They are: (1) domestic violence protective orders, (2) stalking protective orders, and (3) sexual assault protective orders.
---
id: military tribal or AK court
question: |
  What type of information do you want? 
subquestion: |
  This interview has information about civil protective orders from the Alaska Court System.
  
  You may have other options for protective orders.
  
  If any of the people involved are in the military, you may qualify for a protective order from the military.
  
  If any of the people involved are tribal members, you may qualify for a protective order from the Tribal Court.

fields: 
  - I want to learn about: options_for_po
    datatype: checkboxes
    choices: 
      - "asking for a civil protective order from the Alaska Court System.": AK court
      - "military protective orders.": military
      - "Tribal Court protective orders.": tribal
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####
  There are 3 different lengths of time for a domestic violence protective order from the Alaska Court System. (1) A short-term domestic violence protective order starts right away and lasts 20 days. It is also called an ex parte protective order. The other side is not notified the order is being requested but if granted, law enforcement will give the other side a copy and explain what it says. (2) A long-term domestic violence protective order lasts 1 year. You can request a long-term protective order at the same time you ask for a short-term protective order. The other side is notified if you request this. The court schedules a hearing about 20 days after you ask for the long-term order and both sides can testify. If a short-term or long-term domestic violence protective order is granted, the court will prohibit the other side from committing domestic violence. (3) There is a third type of domestic violence protective order called an emergency domestic violence protective order. While uncommon, a law enforcement officer can request an emergency domestic violence protective order on behalf of a victim and if granted, it lasts for 72 hours.
---
id: Also want AK court information?
question: |
  Would you also like information about asking for a civil protective order from the Alaska Court System.
yesno: court_info_also
---
id: Who is the protective order for?
question: |
  Who do you want the protective order for?
fields:
  Who is the order for?: who_needs_the_order
  datatype: radio
  choices:
    - "Myself": self
    - "My minor child": child
    - "Myself and my minor child": self and child
    - "More than one of my minor children": children
    - "Myself and more than one of my minor children": self and children
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####
  If I get a protective order, does it include my child?

  Your child can be included in your protective order or have their own protective order depending on what you ask for.

  Ask for yourself: If you have children with the person you are asking for the protective order against, you can ask the judge to:

    *	make some temporary orders about where the child will live;
    *	order child support; and
    *	order the other person to stay away from specific locations, including your child's school.

  You can ask for these things even if the other person did not commit domestic violence against your child.

  Ask for yourself and your child: You can ask for a protective order for yourself and your child, if your child meets all of the protective order requirements. For example, the other person must have committed domestic violence against your child. You can also ask the judge to:

    *	make some temporary orders about where the child will live;
    *	order child support; and
    *	order the other person to stay away from specific locations, including your child's school.

  You must decide before you fill out the court forms so you know which form to use. The court has 2 different forms to ask for a protective order. The forms are called a petition. One petition asks for a protective order for 1 person. The other petition asks for a protective order for more than 1 person.
---
id: petitioner's relationship to other party
question: |
  % if who_needs_the_order == 'self':
  You
  % elif who_needs_the_order == 'self and child':
  You and 
  % if petitioner_related_to_child == 'parent':
  your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  the
  % endif
  child
  % elif who_needs_the_order == 'self and children':
  You and 
  % if petitioner_related_to_child == 'parent':
  your
  % elif petitioner_related_to_child in('guardian', 'representative'):
  the
  % endif
  children
  % endif
  may qualify for a domestic violence protective order in Alaska if:  
subquestion: |
  % if who_needs_the_order == 'self':
  
    * you have a certain relationship with the other person, and
    * the other person committed a crime of domestic violence against you.

  If you do not have a qualifying relationship, you may qualify for a stalking or sexual assault protective order if the other person stalked you or had sexual contact with you without consent.
  
 
  % elif who_needs_the_order == 'self and child':
  % if petitioner_related_to_child == 'parent':

    * you and your child have a certain relationship with the other person, and
    * the other person committed a crime of domestic violence against both of you.

  When you ask for a domestic violence protective order for more than 1 person, each person you are asking for must have the relationship and have experienced the behavior.
  % elif petitioner_related_to_child in('guardian', 'representative'):

    * you and the child have a certain relationship with the other person, and
    * the other person committed a crime of domestic violence against both of you.

  If the child does not have a qualifying relationship, they may qualify for a stalking or sexual assault protective order if the other person stalked the child or had sexual contact with the child without consent.
  % endif
  
  % elif who_needs_the_order == 'children':
  % if petitioner_related_to_child == 'parent':
  
    * your children have a certain relationship with the other person, and
    *	the other person committed a crime of domestic violence against each of your children.

  When you ask for a domestic violence protective order for more than 1 child, each child you are asking for must have the relationship and have experienced the behavior.
  % elif petitioner_related_to_child in('guardian', 'representative'):
  
    * the children have a certain relationship with the other person, and
    * the other person committed a crime of domestic violence against each of your children.

  When you ask for a domestic violence protective order for more than 1 child, each child you are asking for must have the relationship and have experienced the behavior.
  % endif
  
  % elif who_needs_the_order == 'self and children':
  
    * you all have a certain relationship with the other person, and
    *	the other person committed a crime of domestic violence against all of you.

  % endif 

fields:
  # SELF path
  - "Your relationship with the other person": self_related_to_abuser
    datatype: checkboxes
    code: |
      self_related_to_abuser_choices
    none of the above: None of these relationships
    show if:
      code: |
        who_needs_the_order == 'self'  or (((who_needs_the_order == 'self and child' and petitioner_related_to_child == 'parent') or (who_needs_the_order == 'self and children' and petitioner_related_to_child == 'parent')) and not po_against_other_parent) or (who_needs_the_order == 'self and child' and petitioner_related_to_child in ('guardian', 'representative')) or (who_needs_the_order == 'self and children' and petitioner_related_to_child in ('guardian', 'combination'))

  # guardian and child path — child's relationship
  - "The child's relationship with the other person": guardian_and_child_child_related_to_abuser
    datatype: checkboxes
    code: |
      guardian_for_child_related_to_abuser_choices
    none of the above: None of these relationships
    show if:
      code: |
        who_needs_the_order == 'self and child' and petitioner_related_to_child in ('guardian', 'representative')
    js show if: |
      val('self_related_to_abuser').length > 0

under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####
  % if who_needs_the_order == 'self':
  Why does my relationship with the other person matter?

  You need one of these relationships to receive a domestic violence protective order. If you do not have one of these relationships, you may qualify for a stalking or sexual assault protective order if the other person stalked you or had sexual contact with you without consent.
  % elif who_needs_the_order == 'child':
    
    % if petitioner_related_to_child == 'parent': 
    Why does my child's relationship with the other person matter?

  Your child needs a certain type of relationship with the other person to receive a domestic violence protective order. If your child does not have one of these relationships, your child may still qualify for a domestic violence protective order if you or the child’s other parent have a qualifying relationship. You will be asked about that if needed.
    % elif petitioner_related_to_child in('guardian', 'representative'):
    Why does the child's relationship with the other person matter?

  The child needs one of these relationships to receive a domestic violence protective order. If the child does not have one of these relationships, the child may qualify for a stalking or sexual assault protective order if the other person stalked the child or had sexual contact with the child without consent.
    % elif petitioner_related_to_child == 'parent' and who_needs_po_related_to_abuser.all_false():
    Why does my  relationship with the other person matter?

    If your child does not have one of the qualifying relationships, your child may still qualify for a protective order if you have a qualifying relationship with the other person. For example, if you are asking for a protective order for your minor child against someone you are dating.
    % endif
  % endif
---
comment: |
  Establishing relationships when parent filing for self, child or children, or self and child or children, or when guardian filing and guardian does not have a relationship with other party.
id: parent and child relationship with other party 
question: |
  % if who_needs_the_order in ('child', 'self and child','children','self and children'):
  % if petitioner_related_to_child == 'parent':
  Your
  % elif petitioner_related_to_child in('guardian', 'representative', 'combination'):
  The 
  % endif 
  % if who_needs_the_order in('child', 'self and child'):
  child
  % elif who_needs_the_order in('children', 'self and children'):
  children
  % endif
  % endif
  may qualify for a domestic violence protective order in Alaska if:  
subquestion: |
  % if who_needs_the_order in('child', 'self and child'):
  % if petitioner_related_to_child == 'parent':
  
    * your child has a certain relationship with the other person, and
    * the other person committed a crime of domestic violence against your child.

  If your child does not have a qualifying relationship, they may qualify for a stalking or sexual assault protective order if the other person stalked your child or had sexual contact with your child without consent.
  % elif petitioner_related_to_child in('guardian', 'representative'):
  
    * the child has a certain relationship with the other person, and
    * the other person committed a crime of domestic violence against the child.

  If the child does not have a qualifying relationship, they may qualify for a stalking or sexual assault protective order if the other person stalked the child or had sexual contact with the child without consent.
  % endif
  
  
  % elif who_needs_the_order in('children', 'self and children'):
  % if petitioner_related_to_child == 'parent':
  
    * your children have a certain relationship with the other person, and
    *	the other person committed a crime of domestic violence against each of your children.

  When you ask for a domestic violence protective order for more than 1 child, each child you are asking for must have the relationship and have experienced the behavior.
  % elif petitioner_related_to_child in('guardian', 'representative', 'combination'):
  
    * the children have a certain relationship with the other person, and
    * the other person committed a crime of domestic violence against each of your children.

  When you ask for a domestic violence protective order for more than 1 child, each child you are asking for must have the relationship and have experienced the behavior.
  % endif
  % endif 

fields:
  # CHILD path — child’s relationship always first
  - "Your child's relationship with the other person": child_related_to_abuser
    datatype: checkboxes
    code: |
      child_related_to_abuser_choices
    none of the above: None of these relationships
    show if:
      code: |
        who_needs_the_order in('child', 'self and child') and petitioner_related_to_child == 'parent'

  # CHILD path — petitioner's relationship (only if child picked None of these)
  - "Your relationship with the other person": parent_related_to_abuser
    datatype: checkboxes
    code: |
      self_related_to_abuser_choices
    none of the above: None of these relationships
    show if:
      code: |
        who_needs_the_order == 'child' and petitioner_related_to_child == 'parent'
    js show if: |
      val("child_related_to_abuser[nota]")


  # CHILD path — other parent's relationship (only if child == None and petitioner == None)
  - "The other parent's relationship with the other person": other_parent_related_to_abuser
    datatype: checkboxes
    code: |
      other_parent_related_to_abuser_choices
    none of the above: None of these relationships
    show if:
       code: |
         who_needs_the_order == 'child' and petitioner_related_to_child == 'parent'
    js show if: |
      val('child_related_to_abuser[nota]') && val('parent_related_to_abuser[nota]')



  # CHILD when parent filing for self and child does not have qualifying relationship path and decides what next to explore — other parent's relationship (only if child == None and filing parent has petitioner == None)
  - "The other parent's relationship with the other person": filing_parent_does_not_qualify_other_parent_related_to_abuser
    datatype: checkboxes
    code: |
      other_parent_related_to_abuser_choices
    none of the above: None of these relationships
    show if:
       code: |
         who_needs_the_order == 'self and child' and petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false()
    js show if: |
      val('child_related_to_abuser[nota]')

  # CHILD path — child's relationship (if petitioner == guardian or representative)
  - "The child's relationship with the other person": guardian_for_child_related_to_abuser
    datatype: checkboxes
    code: |
      guardian_for_child_related_to_abuser_choices
    none of the above: None of these relationships
    show if:
       code: |
         who_needs_the_order in('child', 'self and child') and petitioner_related_to_child in('guardian', 'representative')
      
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####
  % if who_needs_the_order == 'self':
  Why does my relationship with the other person matter?

  You need one of these relationships to receive a domestic violence protective order. If you do not have one of these relationships, you may qualify for a stalking or sexual assault protective order if the other person stalked you or had sexual contact with you without consent.
  % elif who_needs_the_order == 'child':
    
    % if petitioner_related_to_child == 'parent': 
    Why does my child's relationship with the other person matter?

  Your child needs a certain type of relationship with the other person to receive a domestic violence protective order. If your child does not have one of these relationships, your child may still qualify for a domestic violence protective order if you or the child’s other parent have a qualifying relationship. You will be asked about that if needed.
    % elif petitioner_related_to_child in('guardian', 'representative'):
    Why does the child's relationship with the other person matter?

  The child needs one of these relationships to receive a domestic violence protective order. If the child does not have one of these relationships, the child may qualify for a stalking or sexual assault protective order if the other person stalked the child or had sexual contact with the child without consent.
    % elif petitioner_related_to_child == 'parent' and who_needs_po_related_to_abuser.all_false():
    Why does my relationship with the other person matter?

    If your child does not have one of the qualifying relationships, your child may still qualify for a protective order if you have a qualifying relationship with the other person. For example, if you are asking for a protective order for your minor child against someone you are dating.
    % endif
  % endif
---
code: |
  self_related_to_abuser_choices = [
      {'married': "Married to each other now"},
      {'divorced': "Married to each other in the past"},
      {'have child': "Have child together"},
      {'dated': "In a dating or sexual relationship now or in past"},
      {'cohabited': "Live together now or in past (roommates or romantic relationship)"},
      {'marriage related': "Related by marriage now or in past (such as in-laws)"},
      {'blood': "Blood relatives such as parents, siblings, children, grandchildren, aunts, uncles, nephews, nieces, and first cousins"}
  ]
---
code: |
  child_related_to_abuser_choices  = [
      {'married': "Married to each other now or in the past"},
      {'have child': "Have child together"},
      {'dated': "In a dating or sexual relationship now or in past"},
      {'cohabited': "Live together now or in past (roommates or romantic relationship)"},
      {'marriage related': "Related by marriage now or in past (such as in-laws)"},
      {'blood': "Blood relatives such as parents, siblings, children, grandchildren, aunts, uncles, nephews, nieces, and first cousins"}
  ]
---
code: |
  guardian_for_child_related_to_abuser_choices  = [
      {'married': "Married to each other now or in the past"},
      {'have child': "Have child together"},
      {'dated': "In a dating or sexual relationship now or in past"},
      {'cohabited': "Live together now or in past (roommates or romantic relationship)"},
      {'marriage related': "Related by marriage now or in past (such as in-laws)"},
      {'blood': "Blood relatives such as parents, siblings, children, grandchildren, aunts, uncles, nephews, nieces, and first cousins"},
      {'parent related to abuser': "One of their parents has one of the relationships listed above",
       'help': "Check this box if either of the child's parents has one of these relationships with the other person: - Married to each other now or in the past, - Have child together, - In a dating or sexual relationship now or in past, - Live together now or in past (roommates or romantic relationship) - Related by marriage now or in past (such as in-laws), - Blood relatives such as parents, siblings, children, grandchildren, aunts, uncles, nephews, nieces, and first cousins"}
  ]
---
code: |
  other_parent_related_to_abuser_choices  = [
      {'married': "Married to each other now or in the past"},
      {'have child': "Have child together"},
      {'dated': "In a dating or sexual relationship now or in past"},
      {'cohabited': "Live together now or in past (roommates or romantic relationship)"},
      {'marriage related': "Related by marriage now or in past (such as in-laws)"},
      {'blood': "Blood relatives such as parents, siblings, children, grandchildren, aunts, uncles, nephews, nieces, and first cousins"}
  ]

---
id: child with other side
question: |
  Do you and the other person have any children together?
yesno: child_w_abuser
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####
  Why does this matter?

  If you and the other person have any children together, you can ask the court to make a parenting schedule and order child support as part of the protective order case.
---
id: children or self and children may qualify
question: |
  % if who_needs_the_order == 'children':
  ${ 'Your' if petitioner_related_to_child == 'parent' else 'the' } children 
  % else:
  You and  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } children 
  % endif
  may qualify for a domestic violence protective order in Alaska if
   % if who_needs_the_order == 'children':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } 
  % else:
  you and  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' }
  % endif
   children:
subquestion: |
    
    * Have a certain relationship with the other person, and
    * the other person committed a crime of domestic violence against
    % if who_needs_the_order == 'self and children':
    all of you.
    % else:
    each of ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } children.
    % endif
    
    When you ask for a domestic violence protective order for more than 1 child, each child you are asking for must have the relationship and have experienced the behavior.

continue button field: domestic_violence_po_criteria
---
id: more than one child has a relationship with abuser
question: |
  Does each child have 1 of these relationships with the other person?
subquestion: |
  &nbsp;

  * Married to each other now or in the past.
  * Have a child together.
  * In a dating or sexual relationship now or in past.
  * Live together now or in past (roommates or romantic relationship).
  * Related by marriage now or in past (such as in-laws).
  * Blood relatives such as parents, siblings, children, grandchildren, aunts, uncles, nephews, nieces, and first cousins.
  % if who_needs_the_order == 'children' and petitioner_related_to_child == 'parent':
  * You or the other parent has one of the relationships listed above.
  <span class="da-help-wrap">
    <span class="da-help-icon"><i class="fa fa-question-circle text-primary" aria-hidden="true"></i></span>
    <div class="da-help-box" role="note">
      <p style="margin:0 0 .3em 0;">This applies if you or the children’s other parent has one of these relationships with the other person:</p>
      <ul>
        <li>Married to each other now or in the past</li>
        <li>Have a child together</li>
        <li>In a dating or sexual relationship now or in the past</li>
        <li>Live together now or in the past (roommates or romantic relationship)</li>
        <li>Related by marriage now or in the past (such as in-laws)</li>
        <li>Blood relatives such as parents, siblings, children, grandchildren, aunts, uncles, nephews, nieces, and first cousins</li>
      </ul>
    </div>
  </span>
  % else:
  * One of their parents has one of the relationships listed above.
  <span class="da-help-wrap">
    <span class="da-help-icon"><i class="fa fa-question-circle text-primary" aria-hidden="true"></i></span>
    <div class="da-help-box" role="note">
      <p style="margin:0 0 .3em 0;">This applies if one of the children’s parents has one of these relationships with the other person:</p>
      <ul>
        <li>Married to each other now or in the past</li>
        <li>Have a child together</li>
        <liIn a dating or sexual relationship now or in the past</li>
        <li>Live together now or in the past (roommates or romantic relationship)</li>
        <li>Related by marriage now or in the past (such as in-laws)</li>
        <li>Blood relatives such as parents, siblings, children, grandchildren, aunts, uncles, nephews, nieces, and first cousins</li>
      </ul>
    </div>
  </span>
  % endif 

fields:
  - no label: children_related_to_abuser  
    datatype: radio
    choices:
      code: |
        children_related_to_abuser_choices
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####
  Why does the number of people with the relationship matter?

  The court has forms to ask for a protective order for one person or for more than one person. Your answers help decide which form you need.
---
code: |
  if who_needs_the_order == 'children':
    children_related_to_abuser_choices = [
      {'all': "All of the children have a listed relationship."},
      {'one': "Only 1 child has a listed relationship."},
      {'some': "Some of the children, but not all of the children, have a listed relationship."},
      {'none': "None of the children have a listed relationship."}
    ] 
  else:
    children_related_to_abuser_choices = [
      {'all': "Yes. All the children have a listed relationship."},
      {'one': "Yes. One or more children, but not all of the children, have a listed relationship."},
      {'none': "No. None of the children have a listed relationship."}
    ] 

---
code: |
  help_html_parent = "This applies if you or the children’s other parent has one of these relationships with the other person:"
  help_html_guardian_parent = "This applies if one of the children’s parents has one of these relationships with the other person:"
---
id: dv - crime
question: |
  Did the other person commit a domestic violence crime against 
  % if who_needs_the_order == 'self':
  you?
  % elif who_needs_the_order == 'child':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } child?
  % elif who_needs_the_order == 'children':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' }
  % if children_related_to_abuser in('one', 'some') and what_next_for_children == 'order for one':
  child?
  % else:  
  children?
  % endif
  % elif who_needs_the_order == 'self and child':
    % if petitioner_related_to_child == 'parent':
      % if po_against_other_parent:
      you and your child?
      % elif self_related_to_abuser.any_true():
      you and your child?
      % elif self_related_to_abuser.all_false() and what_next == 'stop for me' and (child_related_to_abuser.any_true() or (child_related_to_abuser.all_false and filing_parent_does_not_qualify_other_parent_related_to_abuser.any_true())):
      your child?
      % endif
    % elif petitioner_related_to_child in('guardian', 'representative'):
      % if self_related_to_abuser.all_false() and what_next == 'stop for me' and guardian_for_child_related_to_abuser.any_true():
      the child?
      % elif self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.all_false() and what_next == 'stop for child':
      you?
      % else:
      you and the child?
      % endif
    % endif
  % elif who_needs_the_order == 'self and children':
    % if petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false() and what_next == 'stop for me':
      % if children_related_to_abuser == 'one' and what_next_for_children == 'order for one':
      ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } child?
      % elif children_related_to_abuser == 'all' or (children_related_to_abuser == 'one' and what_next_for_children == 'order for more'):
      ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } children?
      % endif
    % elif petitioner_related_to_child in ('guardian', 'combination') and self_related_to_abuser.any_true() and children_related_to_abuser == 'none' and what_next == 'stop for child':
    you?
  % else:
  you and ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } children?
  % endif
  % endif
subquestion: |
  To get a protective order, the other person must have committed a "domestic violence crime" against 
  % if who_needs_the_order == 'self':
  you.
  % elif who_needs_the_order == 'child':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } 
  child.
  % elif who_needs_the_order == 'children':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' }
  % if children_related_to_abuser in('one', 'some') and what_next_for_children == 'order for one':
  child.
  % else:  
  children.
  % endif
  % elif who_needs_the_order == 'self and child':
    % if petitioner_related_to_child == 'parent':
      % if po_against_other_parent:
      you and your child.
      % elif self_related_to_abuser.any_true():
      you and your child.
      % elif self_related_to_abuser.all_false() and what_next == 'stop for me' and (child_related_to_abuser.any_true() or (child_related_to_abuser.all_false and filing_parent_does_not_qualify_other_parent_related_to_abuser.any_true())):
      your child.
      % endif
    % elif petitioner_related_to_child in('guardian','representative'):
      % if self_related_to_abuser.all_false() and what_next == 'stop for me' and guardian_for_child_related_to_abuser.any_true():
      the child.
      % elif self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.all_false() and what_next == 'stop for child':
      you.
      % else:
      you and the child.
      % endif
    % endif
  % elif who_needs_the_order == 'self and children':
   % if petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false():
  % if children_related_to_abuser == 'one' and what_next_for_children == 'order for one':
  your child.
  % elif children_related_to_abuser == 'all' or (children_related_to_abuser == 'one' and what_next_for_children == 'order for more'):
  your children.
  % endif
    % elif petitioner_related_to_child in('guardian', 'combination') and self_related_to_abuser.any_true() and children_related_to_abuser == 'none' and what_next == 'stop for child':
  you.
  % else:
  you and the children.
  % endif
  % endif

  The list of these crimes is below. You do not need to know the exact name or definition of the crime. But you need to tell the judge what happened. 
  
  For example, if they hit 
  % if who_needs_the_order == 'self':
  you,
  % elif who_needs_the_order == 'child':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } child,
  % elif who_needs_the_order == 'self and child':
    % if petitioner_related_to_child == 'parent':
      % if po_against_other_parent:
      you or your child,
      % elif self_related_to_abuser.all_false():
      you or your child,
      % if what_next == 'stop for me' and (child_related_to_abuser.any_true() or (child_related_to_abuser.all_false() and filing_parent_does_not_qualify_other_parent_related_to_abuser.any_true())):
      your child
      % endif
      % elif self_related_to_abuser.any_true():
      you or your child,
      % endif
    % elif petitioner_related_to_child in('guardian', 'representative'):
      % if self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.any_true():
      you or the child,
      % elif self_related_to_abuser.all_false() and what_next == 'stop for me' and guardian_for_child_related_to_abuser.any_true():
      the child
      % elif self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.all_false() and what_next == 'stop for child':
      you
      % endif
    % endif
  % elif who_needs_the_order == 'children':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' }
  % if children_related_to_abuser in('one', 'some')  and what_next_for_children == 'order for one':
  child
  % else:
  children
  % endif
  % elif who_needs_the_order == 'self and children':
   % if petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false() and what_next == 'stop for me': 
  % if children_related_to_abuser == 'one' and what_next_for_children == 'order for one':
  your child
  % elif children_related_to_abuser == 'all' or (children_related_to_abuser == 'one' and what_next_for_children == 'order for more'):
  your children
  % endif
    % elif petitioner_related_to_child in('guardian', 'combination') and self_related_to_abuser.any_true() and children_related_to_abuser == 'none' and what_next == 'stop for child':
  you
  % else:
  you and the children
  % endif
  % endif
  or made 
  % if who_needs_the_order == 'self':
  you
  % elif who_needs_the_order == 'child':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } child
  % elif who_needs_the_order == 'self and child':
    % if petitioner_related_to_child == 'parent':
      % if po_against_other_parent:
      you or your child or 
      % elif self_related_to_abuser.any_true():
      you or your child or 
      % endif
    % elif petitioner_related_to_child in('guardian', 'representative'):
      % if self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.any_true():
      you or the child
      % elif self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.all_false() and what_next == 'stop for child':
      you
      % endif
    % endif
  % elif who_needs_the_order == 'children':
    ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } 
  % if children_related_to_abuser in('one', 'some') and what_next_for_children == 'order for one':
  child
  % else:
  children
  % endif
  % elif who_needs_the_order == 'self and children':
   % if petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false() and what_next == 'stop for me':
  % if children_related_to_abuser == 'one' and what_next_for_children == 'order for one':
  your child
  % elif children_related_to_abuser == 'all' or (children_related_to_abuser == 'one' and what_next_for_children == 'order for more'):
  your children
  % endif
    % elif petitioner_related_to_child in('guardian', 'combination') and self_related_to_abuser.any_true() and children_related_to_abuser == 'none' and what_next == 'stop for child':
  you
  % else:
  you and ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } children
  % endif
  % endif
  scared they were going to hurt
  % if who_needs_the_order == 'self':
  you.
  % elif who_needs_the_order == 'child':
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } child.
  % elif who_needs_the_order == 'self and child':
    % if petitioner_related_to_child == 'parent':
      % if po_against_other_parent:
      you,
      % elif self_related_to_abuser.any_true():
      you,
      % elif self_related_to_abuser.all_false() and what_next == 'stop for me' and (child_related_to_abuser.any_true() or (child_related_to_abuser.all_false() and filing_parent_does_not_qualify_other_parent_related_to_abuser.any_true())):
      your child,
      % endif
    % elif petitioner_related_to_child in('guardian', 'representative'):
      % if self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.any_true():
      you,
      % elif self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.all_false() and what_next == 'stop for child':
      you,
      % elif self_related_to_abuser.all_false() and what_next == 'stop for me' and guardian_for_child_related_to_abuser.any_true():
      the child,
      % endif
    % endif
  % elif who_needs_the_order == 'children':
   them,
  % elif who_needs_the_order == 'self and children':
   % if petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false():
  them,
  % else:
  you,
  % endif
  % endif
  that’s a domestic violence crime.
fields:
  - "Did the other person commit a domestic violence crime?": dv_crime
    datatype: radio
    choices:
      code: |
        dv_crime_choices
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####
  What are the domestic violence crimes?
  
  Assault, Criminal mischief, Harassment, Reckless endangerment, Arson or Criminally Negligent Burning, Burglary, Criminal trespass, Cruelty to pets, Custodial interference, Extortion or Coercion, Homicide, Human trafficking, Kidnapping, Reckless endangerment, Robbery, Sexual offenses, Stalking, Terroristic threatening, Violating a protective order.
auto terms:
  Assault: |
      physically hurting someone including making someone afraid they are about to be hurt
  Criminal mischief: |
    damaging someone's property
  Harassment: |
    including repeated calls at extremely inconvenient times
  Reckless endangerment: |
    recklessly behaving in a way that risks serious injury to someone or creating a high risk of serious physical injury to another person.
  Arson or Criminally Negligent Burning: |
    starting a fire or explosion that damages someone else’s property or damages the person’s own property but scares someone
  Burglary: |
    being in a building illegally to commit a crime
  Criminal trespass: |
    being illegally on land, in a home, or in a vehicle
  Cruelty to pets: |
    kill or injures an animal that is a pet to intimidate, threaten, or terrorize another person
  Custodial interference: |
    taking a keeping a child without a legal right to do so, and planning to keep the child from their parent for a long time
  Extortion or Coercion: |
    commonly called blackmail, it is threatening someone to get them do give you something or do something they do not want to do.
  Homicide: |
    causing the death of someone else
  Human trafficking: |
    forcing someone to engage in sexual conduct, adult entertainment, or labor)
  Kidnapping: |
    holding a person against their will
  # Reckless endangerment: |
  #   creating a high risk of serious physical injury to another person.
  Robbery: |
    using force or threatening to use force to steal from someone)
  Sexual offenses: |
    sexual assault, sexual abuse of a minor, incest, and indecent exposure. Sexual assault can occur even if the parties are married. For purposes of a domestic violence protective order, crimes involving showing pornography are not included as domestic violence crimes. Crimes involving making pornography with minors, but not adults, are included.
  Stalking: |
    repeatedly contacting someone or their family member without consent in a way that caused them fear of physical injury or death to themself or a family member?
  Terroristic threatening: |
    scaring someone by lying and saying there's a life-threatening situation
  Violating a protective order: |
    doing something that the person was prohibited from doing by a domestic violence, stalking, or sexual assault protective order.
---
code: |
  # Simple yes/no choices for single person cases
  if who_needs_the_order in('self','child') or (who_needs_the_order == 'children' and children_related_to_abuser in('one', 'some')  and what_next_for_children == 'order for one') or (who_needs_the_order == 'self and children' and petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false() and what_next == 'stop for me' and children_related_to_abuser == 'one' and what_next_for_children == 'order for one'):
    dv_crime_choices = [
      {'yes': "Yes"},
      {'no': "No"}
       ]
  # Special case: parent asking for self and child, with complex relationship scenarios
  elif who_needs_the_order == 'self and child' and petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false() and (child_related_to_abuser.any_true() or (child_related_to_abuser.all_false() and filing_parent_does_not_qualify_other_parent_related_to_abuser.any_true())):
    dv_crime_choices = [
      {'yes': "Yes"},
      {'no': "No"}
       ]
  # Special case: guardian/representative with specific relationship scenarios
  elif (who_needs_the_order == 'self and child' and petitioner_related_to_child in('guardian', 'representative') and ((self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.all_false() and what_next == 'stop for child') or (self_related_to_abuser.all_false() and what_next == 'stop for me' and guardian_for_child_related_to_abuser.any_true()))) or (who_needs_the_order == 'self and children' and petitioner_related_to_child in('guardian', 'combination') and self_related_to_abuser.any_true() and children_related_to_abuser == 'none' and what_next == 'stop for child'):
    dv_crime_choices = [
      {'yes': "Yes"},
      {'no': "No"}
       ]
  # Default for self and child (both/one/neither options)
  elif who_needs_the_order == 'self and child':
    dv_crime_choices = [
      {'yes both': "Yes, against both of us."},
      {'yes one': "Yes, against one of us."},
      {'no': "No. Neither of us."}
       ]
  elif who_needs_the_order == 'children' or (who_needs_the_order == 'self and children' and petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false() and what_next == 'stop for me' and (children_related_to_abuser == 'all' or (children_related_to_abuser == 'one' and what_next_for_children ==  'order for more'))):
    dv_crime_choices = [
      {'yes more': "Yes, against more than 1 child."},
      {'yes one': "Yes, against 1 child."},
      {'no': "No. The other person did not commit a domestic violence crime against any of the children."}
       ]
  elif who_needs_the_order == 'self and children' and petitioner_related_to_child in('guardian', 'combination') and self_related_to_abuser.all_false() and what_next == 'stop for me' and children_related_to_abuser in('all', 'one'):
    dv_crime_choices = [
      {'yes more': "Yes, against more than 1 child."},
      {'yes one': "Yes, against 1 child."},
      {'no': "No. The other person did not commit a domestic violence crime against any of the children."}
       ]
  elif who_needs_the_order == 'self and children' and (petitioner_related_to_child == 'parent' and (po_against_other_parent or (not po_against_other_parent and self_related_to_abuser.any_true())) or (petitioner_related_to_child in('guardian', 'combination') and self_related_to_abuser.any_true() and children_related_to_abuser in('all', 'one'))):
    dv_crime_choices = [
      {'yes all': "Yes, against all of us."},
      {'yes some': "Yes, against some of us."},
      {'yes one': "Yes, against one of us."},
      {'no': "The other person did not commit a domestic violence crime against any of us."}
       ]
  elif who_needs_the_order == 'self and children' and petitioner_related_to_child in('guardian', 'combination') and self_related_to_abuser.any_true() and children_related_to_abuser == 'none' and what_next == 'continue for both':
    dv_crime_choices = [
      {'yes all': "Yes, against all of us."},
      {'yes some': "Yes, against some of us."},
      {'yes one': "Yes, against one of us."},
      {'no': "The other person did not commit a domestic violence crime against any of us."}
       ]
---
comment: |
  Thanks to Jonathan for giving me formatting for lengthy answer.   
id: Other protective order
question: |
 % if who_needs_the_order == 'self' or (who_needs_the_order in('self and child', 'self and children') and what_next == 'other po for me'):
  Do you
  % elif who_needs_the_order == 'child' or (who_needs_the_order == 'self and child' and what_next == 'stop for me'):
  Does ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } child
  % elif who_needs_the_order == 'children' or (who_needs_the_order == 'self and children' and self_related_to_abuser.any_true and children_related_to_abuser == 'none' and what_next == 'stop for me'):
  Do ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } children
  % endif 
  qualify for another type of protective order?
subquestion: |
  Based on your answers,
  % if who_needs_the_order == 'self' or (who_needs_the_order in('self and child', 'self and children') and what_next == 'other po for me'):
  you
  % elif who_needs_the_order == 'child' or (who_needs_the_order == 'self and child' and what_next == 'stop for me'):
   ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } child
  % elif who_needs_the_order == 'children' or (who_needs_the_order == 'self and children' and self_related_to_abuser.any_true and children_related_to_abuser == 'none' and what_next == 'stop for me'):
  ${ 'your' if petitioner_related_to_child == 'parent' else 'the' } children
  % endif 
  may not have the type of relationship needed to get a domestic violence protective order. 
  
  Depending on the other person’s actions, a Stalking Protective Order or a Sexual Assault Protective order may be appropriate.
fields:
  - "Did the other person?": other_po
    datatype: radio
    code: |
      other_po_choices
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####

  There are 2 different lengths of time for a stalking or sexual assault protective order?  (1) A short-term protective order starts right away and lasts 20 days.  It is also called an ex parte protective order.  The other side is not notified the order is being requested but if granted, law enforcement will give the other side a copy and explain what it says.  (2) A long-term protective order lasts 1 year.  You can request a long-term protective order at the same time you ask for a short-term protective order.   The other side is notified if you request this. The court schedules a hearing about 20 days after you ask for the long-term order and both sides can testify.  If a short-term or long-term protective order is granted, the court will prohibit the other side from contacting you.

---
code: |
  if who_needs_the_order == 'self' or (who_needs_the_order in('self and child', 'self and children') and what_next == 'other po for me'):
    other_po_choices = [
      {'stalked': "Stalk you by:\n\n1. repeatedly contacting you or a family member\n2. without consent\n3. in a way that caused you fear of physical injury or death to yourself or a family member?" },
      {'sexual contact': "Have sexual contact with you without consent?"},
      {'neither': "The other person did not do either of these."}
    ]
  elif (who_needs_the_order == 'child' or (who_needs_the_order == 'self and child' and what_next == 'stop for me')) and petitioner_related_to_child == 'parent':
    other_po_choices = [
      {'stalked': "Stalk your child by:\n\n1. repeatedly contacting your child or one of your child's family members\n2. without consent\n3. in a way that caused your child fear of physical injury or death to themself or a family member?" },
      {'sexual contact': "Have sexual contact with your child without consent?"},
      {'neither': "The other person did not do either of these."}
    ]
  elif (who_needs_the_order == 'child' or (who_needs_the_order == 'self and child' and what_next == 'stop for me')) and petitioner_related_to_child in('guardian', 'representative'):
    other_po_choices = [
      {'stalked': "Stalk the child by:\n\n1. repeatedly contacting the child or one of the child's family members\n2. without consent\n3. in a way that caused the child fear of physical injury or death to themself or a family member?" },
      {'sexual contact': "Have sexual contact with the child without consent?"},
      {'neither': "The other person did not do either of these."}
    ]
  elif (who_needs_the_order == 'children' or (who_needs_the_order == 'self and children' and what_next == 'stop for me')) and petitioner_related_to_child == 'parent' :
    other_po_choices = [
      {'stalked': "Stalk your children by:\n\n1. repeatedly contacting your children or one of your children's family members\n2. without consent\n3. in a way that caused your children fear of physical injury or death to themself or a family member?" },
      {'sexual contact': "Have sexual contact with your children without consent?"},
      {'neither': "The other person did not do either of these."}
    ]
  elif (who_needs_the_order == 'children' or (who_needs_the_order == 'self and children' and  what_next in('stop for me', 'continue for both'))) and petitioner_related_to_child in('guardian', 'representative', 'combination'):
    other_po_choices = [
      {'stalked': "Stalk the children by:\n\n1. repeatedly contacting the children or one of the children's family members\n2. without consent\n3. in a way that caused the children fear of physical injury or death to themself or a family member?" },
      {'sexual contact': "Have sexual contact with the children without consent?"},
      {'neither': "The other person did not do either of these."}
    ]
  else:
    # Fallback - should not reach here
    other_po_choices = [
      {'stalked': "Stalking" },
      {'sexual contact': "Sexual assault"},
      {'neither': "The other person did not do either of these."}
    ]
---
id: Petitioner's relationship to child or children
question: |
  What is your relationship to the 
  ${ 'child' if who_needs_the_order in('child', 'self and child') else 'children' }?
subquestion: |
fields:
  - no label: petitioner_related_to_child
    datatype: radio
    choices:
      code: |
        petitioner_related_to_child_choices
    
under: |
  #### <i class="fa-regular fa-lightbulb"></i> Learn more####

  Why does the relationship matter?

  Alaska law allows a parent, guardian, or representative appointed by the court to ask for a protective order for a child under age 18.
---
code: |
  if who_needs_the_order in('child', 'self and child'):
    petitioner_related_to_child_choices = [
      {'parent': "Parent"},
      {'guardian': "Guardian"},
      {'representative': "A representative appointed by the court"},
      {'other': "Other"}
       ]
  if who_needs_the_order in('children', 'self and children'):
    petitioner_related_to_child_choices = [
      {'parent': "Parent of all the children."},
      {'guardian': "Guardian or representative appointed by the court for all the children."},
      {'combination': "A combination – a parent of one or more children and guardian or representative of one or more children."},
      {'other': "Other"}
       ]
  
---
id: asking for PO against other parent?
question: |
  Are you asking for a protective order against your ${ "child's" if who_needs_the_order in('child', 'self and child') else "children's" } other parent?
fields:
  - Are you asking for a protective order against your ${ "child's" if who_needs_the_order in('child', 'self and child') else "children's" } other parent?: po_against_other_parent
    datatype: yesnoradio
  - "Did you marry the other parent?": parent_married_parent    
    input type: radio
    choices:
      - Yes, and we are married to each other now.: married
      - Yes, but we are divorced.: divorced
      - No: no
    js show if: |
      val('po_against_other_parent') == true
---
id: What next
question: |
  What do you want to do next?
subquestion: |
  % if who_needs_the_order in('self and child', 'self and children'):
  % if (petitioner_related_to_child == 'parent' and (not po_against_other_parent or (po_against_other_parent and self_related_to_abuser.all_false()))) or (petitioner_related_to_child in('guardian', 'representative', 'combination') and self_related_to_abuser.all_false()):
  Based on your answers, you may not have the type of relationship needed to get a domestic violence protective order.
  
  ${ 'Your' if petitioner_related_to_child == 'parent' else 'The' } ${'child' if who_needs_the_order == 'self and child' else 'children' } may have the type of relationship with the other person that qualifies for a domestic violence protective order.
  
  You may qualify for a stalking or sexual assault protective order if the other person stalked you or had sexual contact with you without consent.
  % else:
  Based on your answers, you may have the type of relationship needed to get a domestic violence protective order, but ${ 'your' if petitioner_related_to_child == 'parent' else 'the' }  ${'child' if who_needs_the_order == 'self and child' else 'children' } may not.
  % endif
  % endif
  
fields:
  - What next?: what_next
    datatype: radio
    code: |
      what_next_choices
---  
id: What next for the children
question: |
  What do you want to do next?
subquestion: |
  Based on your answers, the children do not all have the type of relationship needed to get a domestic violence protective order.
fields:      
  - What next?: what_next_for_children
    input type: radio
    choices:
      - Answer questions about getting a domestic violence protective order for 1 child.: order for one
      - Answer questions about getting a domestic violence protective order for more than 1 child.: order for more
      - Stop answering questions about getting a domestic violence protective order. Answer questions about if a child qualifies for a stalking or sexual assault protective order because the other person stalked a child or had sexual contact with a child without consent.: stop
        help: |
          The stalking and sexual assault forms only have space to ask for an order for one person at a time. If you want to ask for a stalking or sexual assault order against more than 1 child, you will have to fill out more than 1 form.
---
code: |
  ### Step 3 q.5
  if who_needs_the_order == 'self and child' and petitioner_related_to_child == 'parent' and not po_against_other_parent and self_related_to_abuser.all_false():
    what_next_choices = [
      {'stop for me': "Answer questions about if my child has a relationship with the other person that would be appropriate for asking for a domestic violence protective order. This will end questions about my protective order."},
      {'other po for me': "Answer questions about if the other person stalked or sexually assaulted me to get an order for myself? This will end questions about your child."},
    ]

  ### Step 3 q.8
  if who_needs_the_order == 'self and child' and petitioner_related_to_child in ('guardian', 'representative') and self_related_to_abuser.all_false():
    what_next_choices = [
      {'stop for me': "Answer questions about if the child has a relationship with the other person that would be appropriate for asking for a domestic violence protective order. This will end questions about my protective order."},
      {'other po for me': "Answer questions about if the other person stalked or sexually assaulted me to get an order for myself? This will end questions about the child."}
    ]

  ### Step 3 q.11
  if who_needs_the_order == 'self and child' and petitioner_related_to_child in ('guardian', 'representative') and self_related_to_abuser.any_true() and guardian_and_child_child_related_to_abuser.all_false():
    what_next_choices = [
      {'stop for child': "Stop answering questions for the child. Answer questions about asking for a protective order for myself."},
      {'continue for both': "Continue to answer questions about asking for a protective order for myself and the child."},
      {'stop for me': "Stop answering questions for myself. Answer questions about if the child qualifies for a stalking or sexual assault protective order if the other person stalked the child or had sexual contact with the child without consent."}
    ]

  ### Step 5 q.5
  if who_needs_the_order == 'self and children' and ((petitioner_related_to_child == 'parent' and not po_against_other_parent) or petitioner_related_to_child in('guardian', 'combination')) and self_related_to_abuser.all_false():
    possessive_word = 'my' if petitioner_related_to_child == 'parent' else 'the'
    what_next_choices = [
      {'other po for me': "Answer questions about if the other person stalked or sexually assaulted me to get an order for myself? This will end questions about the children."},
      {'stop for me': f"Answer questions about if {possessive_word} children have a relationship with the other person that would be appropriate for asking for a domestic violence protective order. This will end questions about my protective order."}
    ]

  #  ### Step 5 q.5
  #  if who_needs_the_order == 'self and children' and petitioner_related_to_child in('guardian', 'combination') and self_related_to_abuser.all_false():
  #    possessive_word = 'my' if petitioner_related_to_child == 'parent' else 'the'
  #    what_next_choices = [
  #      {'other po for me': "Answer questions about if the other person stalked or sexually assaulted me to get an order for myself? This will end questions about your children."},
  #      {'stop for me': f"Answer questions about if {possessive_word} children have a relationship with the other person that would be appropriate for asking for a domestic violence protective order. This will end questions about my protective order."}
  #    ]

  ### Step 5 q.9
  if who_needs_the_order == 'self and children' and petitioner_related_to_child in ('guardian', 'combination') and self_related_to_abuser.any_true() and children_related_to_abuser == 'none':
    what_next_choices = [
      {'stop for child': "Stop answering questions for the children. Answer questions about asking for a protective order for myself."},
      {'continue for both': "Continue to answer questions about asking for a protective order for myself and the children."},
      {'stop for me': "Stop answering questions for myself. Answer questions about if the children qualify for a stalking or sexual assault protective order if the other person stalked the children or had sexual contact with the children without consent.",
        'help': "The stalking and sexual assault forms only have space to ask for an order for one person at a time. If you want to ask for a stalking or sexual assault order against more than 1 child, you will have to fill out more than 1 form."
      }
    ]
---
id: What form want?
question: |
    Which form do you want to learn about?
subquestion: |
  The court has different forms for asking for a protective order. You can ask for a protective order for 1 person or for more than 1 person. 
  
  Based on your answers, only 1 person may have experienced the domestic violence behavior.
fields:
  - Which form?: which_po_form
    datatype: radio
    choices:
      - Asking for a Domestic Violence Protective Order for 1 person: one person dv form
      - Asking for a Domestic Violence Protective Order for more than 1 person: multi person dv form
 
---
###### Step 7 2025-11-12 ######
id: short or long term
question: |
  Is your Alaska protective order a 20-day order or long-term (1 year) order?
fields:
  - Short or long-term?: term
    datatype: radio
    code: |
      term_choices
    choices:
      - "20-day order": short
      - "long-term (1 year) order": long 
---
code: |
  if user_need == 'have po':
    term_choices = [
      {'short': "20-day order."},
      {'long': "long-term (1 year) order."
      }
    ] 
  elif user_need == 'po respondent':
    term_choices = [
      {'short': "20-day order."},
      {'long': "long-term (1 year) order."},
      {'hearing': "There is no protective order against me right now. There is a hearing for a long term protective order."
      }
    ] 
---
id: request long
question: |
  % if user_need == 'have po':
  When you asked for the 20-day order, did you also ask for a long-term protective order?
  % elif user_need == 'po respondent':
  Did the other side request a long-term protective order as well?
  % endif 
fields:
  - Request long-term?: request_long
    datatype: yesnoradio
---
id: married or kids
question: |
  Do you have a child with the other person?
fields:
  - no label: shared_child
    datatype: yesnoradio
  - What is your situation?: custody
    datatype: radio
    choices:
      - "Married.": married
      - "Divorced.": divorced
      - "Never married, but I have a custody order.": custody order
      - "Never married, and we do not have a custody order.": no custody order
    js show if: |
      val('shared_child') == true
---
id: married to the other person
question: |
  Are you married to the other person?
fields:
  - Married?: married
    datatype: yesnoradio
---
id: more info petitioner or respondent
question: |
  What would you like to learn about?
subquestion: |
  Check all that apply.
fields:
  - I want to learn about: petitioner_choices
    datatype: checkboxes
    code: |
      choices_choices
    show if:
      code: |
        user_need == 'have po'
        
  - I want to learn about: respondent_choices
    datatype: checkboxes
    code: |
      choices_choices
    show if:
      code: |
        user_need == 'po respondent'
---
code: |
  if user_need == 'have po':
    ### If petitioner only has a 20-day, short-term protective order
    if term == 'short' and not request_long:
      choices_choices = [
        {'options': "Options if the other side violates the protective order."},
        {'change': "Asking the judge to change the protective order."},
        {'end': "Asking the judge to end the protective order."},
        {'respond': "Responding if the other side asks to change or end the order."
        }
      ]
    
    ### If petitioner only has a 20-day, short-term protective order
    elif term == 'short' and request_long:
      choices_choices = [
        {'options': "Options if the other side violates the protective order."},
        {'change': "Asking the judge to change the protective order."},
        {'end': "Asking the judge to end the protective order."},
        {'respond': "Responding if the other side asks to change or end the order."},
        {'dismiss': "Asking the judge to dismiss a petition for a long-term protective order before deciding if it should be granted."
        }
      ]
    
    ### If petitioner has a long term protective order or a 20 day, short term order and has asked for long term order
    elif term == 'long':
      choices_choices = [
        {'options': "Options if the other side violates the protective order."},
        {'change': "Asking the judge to change the protective order."},
        {'extend': "Asking the judge to extend the protective order."},
        {'end': "Asking the judge to end the protective order."},
        {'respond': "Responding if the other side asks to change or end the order."
        }
      ]
  
  elif user_need == 'po respondent':
    choices_choices = [
      {'dismiss': "Asking the judge to dismiss a petition for a long-term protective order before deciding if it should be granted."},
      {'change': "Asking the judge to change the protective order."},
      {'end': "Asking the judge to end the protective order."},
      {'respond': "Responding if the other side asks to change or end the order."},
      {'respond to extend': "Responding if the other side asks to extend the order."
      }
    ]
---
id: expired yet
question: |
    Has the long-term protective order expired yet?
fields:
  - Expired?: expired
    datatype: yesnoradio
---
id: how long ago
question: |
  How long ago did the long-term protective order expire?
subquestion: |
fields:
  - How long ago?: expired_days_ago
    datatype: radio
    choices:
      - "Less than 60 days ago.": less than 60 days
      - "More than 60 days ago.": more than 60 days
---
id: how long until
question: |
  How long until the current long-term protective order expires?
subquestion: |
fields:
  - How long?: will_expire
    datatype: radio
    choices:
      - "Less than 10 days.": less than 10 days
      - "More than 10 days.": more than 10 days
---
id: too long
question: |
  If your protective order expired more than 60 days ago, it cannot be extended. 
fields:
  - Would you like information about asking for a new protective order?: new_order_info
    datatype: yesnoradio
---
id: also change
question: |
  Would you like information about asking the judge to change the protective order?
subquestion: |
  If you think you would be safer if the protective order has more protections, you can ask the judge to change the order and add more protections for you.  
fields:
  - Would you like more information?: also_change
    datatype: yesnoradio
---
id: what type of order
question: |
  What type of protective order do you have?
fields:
  - I have: po_case_type
    datatype: radio
    choices:
      - "A Domestic Violence Protective Order with 1 petitioner": 1 person
      - "A Domestic Violence Protective Order with more than 1 petitioner.": more than 1
      - "A Stalking Protective Order.": stalking
      - "A Sexual Assault Protective Order.": sexual assault
---
###### Step 7 2025-11-18 ######
id: Info on different types of orders	
question: |
  The same event can have several different court cases and several different orders not to contact the other person
subquestion: |
  If the police arrested you for the same reason that led to the protective order against you, you may have a criminal case.  The criminal case may have a condition that you not contact the other person as part of your bail conditions for release.  If you violate the condition, you may no longer be released on bail and it may be a new crime.

  If someone has a civil protective order against you, it orders you not to contact them.  If you violate the order, it can be a new criminal case separate from the civil protective order case.
  
  Each case has different restrictions.  If one case is dismissed, it usually does not change the restrictions in the other cases.
  
  If you have multiple court cases, be sure you understand what each case requires so that you do not violate any of them.
continue button field: respondent_intro
---
# ALDocument objects specify the metadata for each template
objects:
  - protective_order_action_plan_attachment: ALDocument.using(title="Responding in your case to end your marriage - Action Plan", filename="protective_order_action_plan", enabled=True, has_addendum=False, suffix_to_append="")
---
# Bundles group the ALDocuments into separate downloads, such as for court and for the user
objects:
  - al_user_bundle: ALDocumentBundle.using(elements=[protective_order_action_plan_attachment], filename="protective_order_action_plan", title="All forms to download for your records", enabled=True)
  # - al_court_bundle: ALDocumentBundle.using(elements=[protective_order_action_plan_attachment],  filename="protective_order_action_plan", title="All forms to deliver to court", enabled=True)
---
# Each attachment defines a key in an ALDocument. We use `i` as the placeholder here so the same template is 
# used for "preview" and "final" keys, and logic in the template checks the value of 
# `i` to show or hide the user's signature
---
attachment:
  name: Protective Order Action Plan
  filename: protective_order_action_plan
  update references: True
  variable name: protective_order_action_plan_attachment[i]
  skip undefined: True
  docx template file: dummy.docx
  # docx template file: protective_order_action_plan.docx
  tagged pdf: True
---
attachment:
  name: Protective Order Action Plan
  filename: protective_order_action_plan
  update references: True
  variable name: docx_protective_order_action_plan_attachment
  skip undefined: True
  docx template file: dummy.docx
  # docx template file: protective_order_action_plan.docx
  tagged pdf: True